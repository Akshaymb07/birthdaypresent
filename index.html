<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Birthday üéÇ</title>
  <meta name="description" content="An interactive birthday surprise." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
  <!-- Tailwind (CDN build) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { display: ['Poppins', 'ui-sans-serif', 'system-ui'] },
          colors: {
            brand: {
              50: '#fff1f2', 100: '#ffe4e6', 200: '#fecdd3', 300: '#fda4af', 400: '#fb7185',
              500: '#f43f5e', 600: '#e11d48', 700: '#be123c', 800: '#9f1239', 900: '#881337'
            }
          }
        }
      }
    }
  </script>
  <!-- Confetti -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <style>
    :root {
      --bg: radial-gradient(1200px 600px at 10% -10%, #ffe4e6 0%, transparent 40%), radial-gradient(900px 500px at 110% 0%, #e0f2fe 0%, transparent 45%), #0f172a;
    }

    body {
      background: var(--bg);
    }

    /* Base animations */
    .fade-in {
      animation: fadeIn 0.8s ease forwards;
      opacity: 0;
      transform: translateY(8px);
    }

    @keyframes fadeIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .pop {
      animation: pop .5s ease;
    }

    @keyframes pop {
      0% {
        transform: scale(.9);
      }

      70% {
        transform: scale(1.05);
      }

      100% {
        transform: scale(1);
      }
    }

    .slide-in {
      animation: slideIn 520ms cubic-bezier(.2, .7, .2, 1) both;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(12px) scale(.98);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .ripple {
      position: relative;
      overflow: hidden;
    }

    .tilt {
      transition: transform .15s ease, box-shadow .2s ease;
      transform-style: preserve-3d;
    }

    .tilt:hover {
      transform: translateY(-2px) rotateX(3deg) rotateY(-3deg);
      box-shadow: 0 10px 30px rgba(0, 0, 0, .25);
    }

    .glow {
      box-shadow: 0 0 0 0 rgba(244, 63, 94, .6);
      animation: pulseGlow 1.8s infinite;
    }

    @keyframes pulseGlow {
      0% {
        box-shadow: 0 0 0 0 rgba(244, 63, 94, .6);
      }

      70% {
        box-shadow: 0 0 0 12px rgba(244, 63, 94, 0);
      }

      100% {
        box-shadow: 0 0 0 0 rgba(244, 63, 94, 0);
      }
    }

    /* Cake */
    .flame {
      transform-origin: 50% 100%;
      animation: flicker 0.9s infinite ease-in-out alternate;
    }

    @keyframes flicker {
      from {
        transform: translateY(0) scale(1);
      }

      to {
        transform: translateY(-1px) scale(1.05);
      }
    }

    /* Hearts BG */
    .heart {
      position: absolute;
      color: #f43f5e;
      opacity: 0.25;
      animation: floatUp linear infinite;
    }

    @keyframes floatUp {
      from {
        transform: translateY(100vh) scale(0.9) rotate(0deg);
        opacity: 0.2;
      }

      to {
        transform: translateY(-20vh) scale(1.2) rotate(15deg);
        opacity: 0.05;
      }
    }

    /* Balloons on reveal */
    .balloon {
      position: fixed;
      bottom: -10vh;
      width: 26px;
      height: 34px;
      border-radius: 50% 50% 50% 50%/60% 60% 40% 40%;
      background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, .6), rgba(255, 255, 255, .1) 30%, transparent 35%), var(--balloon);
      animation: fly var(--dur) linear forwards;
      filter: drop-shadow(0 6px 10px rgba(0, 0, 0, .2));
    }

    .balloon::after {
      content: "";
      position: absolute;
      left: 50%;
      top: 100%;
      width: 2px;
      height: 26px;
      background: rgba(255, 255, 255, .6);
      transform: translateX(-50%);
    }

    @keyframes fly {
      to {
        transform: translate(var(--x, 0), -120vh);
      }
    }
  </style>
</head>

<body class="min-h-screen text-slate-100 font-display selection:bg-brand-400 selection:text-white">
  <!-- Floating hearts -->
  <div id="hearts" aria-hidden="true"></div>

  <main class="mx-auto max-w-3xl px-4 py-10">
    <section class="text-center fade-in">
      <h1 id="heroTitle" class="text-5xl md:text-6xl font-extrabold tracking-tight drop-shadow-sm">Hello my cute ‡¥Æ‡µÇ‡¥ô‡µç‡¥ô ‚ú®
      </h1>
      <p id="typewriter" class="mt-3 text-slate-200/80 text-lg"></p>

      <!-- Phases -->
      <div id="phases" class="mt-10">
        <!-- Progress dots -->
        <div class="flex items-center justify-center gap-2" id="progress"></div>

        <!-- Phase container -->
        <div id="phaseContainer" class="mt-6"></div>

        <!-- Nav -->
        <div class="mt-6 flex items-center justify-between">
          <button id="prevBtn" data-ripple
            class="ripple rounded-xl border border-white/20 bg-white/10 hover:bg-white/15 px-4 py-2 disabled:opacity-40">‚Üê
            Back</button>
          <button id="nextBtn" data-ripple
            class="ripple rounded-xl bg-brand-500 hover:bg-brand-600 px-4 py-2 font-semibold glow">Next ‚Üí</button>
        </div>
      </div>

      <!-- Footer small print -->
      <p class="mt-10 text-xs text-slate-300/70">Built with love by Akshay for Lakshmy.</p>
    </section>
  </main>

  <!-- Background music: local file, hidden, autoplay + loop -->
  <audio id="bgm" src="song.mp3" preload="auto" loop autoplay style="display:none"></audio>

  <script>
    // Fixed names
    const RECIPIENT = 'Lakshmy' // gf name
    const SENDER = 'Akshay'
    const photoSrc = 'our-photo.jpg'

    // Autoplay background music with tap-to-start fallback
    document.addEventListener('DOMContentLoaded', () => {
      const bgm = document.getElementById('bgm')
      bgm.volume = 0.65
      bgm.play().catch(() => {
        const gate = document.createElement('div')
        gate.className = 'fixed inset-0 bg-black/70 flex items-center justify-center z-50 text-white'
        gate.innerHTML = '<div class="text-center text-lg font-semibold px-6 py-4 rounded-2xl">üíñ Tap anywhere to start the music üíñ</div>'
        document.body.appendChild(gate)
        const start = () => { bgm.play().finally(() => gate.remove()) }
        document.addEventListener('click', start, { once: true })
        document.addEventListener('touchstart', start, { once: true })
      })
    })

    // Hearts background
    const hearts = document.getElementById('hearts')
      ; (() => {
        const count = 24
        for (let i = 0; i < count; i++) {
          const h = document.createElement('div')
          h.className = 'heart'
          h.style.left = Math.random() * 100 + 'vw'
          h.style.fontSize = (12 + Math.random() * 28) + 'px'
          h.style.animationDuration = (16 + Math.random() * 12) + 's'
          h.textContent = '‚ù§'
          hearts.appendChild(h)
        }
      })()

    const heroTitle = document.getElementById('heroTitle')
    // Parallax wobble
    addEventListener('mousemove', (e) => {
      const { innerWidth: w, innerHeight: h } = window
      const rx = (e.clientY - h / 2) / h * 4
      const ry = (e.clientX - w / 2) / w * -4
      heroTitle.style.transform = `translateZ(0) rotateX(${rx}deg) rotateY(${ry}deg)`
    })

    // Typewriter intro
    const typewriter = document.getElementById('typewriter')
    const introText = `Click the little heart below, then follow the tiny quests I made for you. At the end, a surprise waits for you, ${RECIPIENT} üíï`
      ; (async function typeIt() {
        for (let i = 1; i <= introText.length; i++) {
          typewriter.textContent = introText.slice(0, i)
          await new Promise(r => setTimeout(r, 18))
        }
      })()

    // Simple toast
    function toast(msg) {
      const t = document.createElement('div')
      t.className = 'fixed left-1/2 -translate-x-1/2 bottom-6 bg-white text-slate-900 rounded-xl px-4 py-2 shadow-lg pop'
      t.textContent = msg
      document.body.appendChild(t)
      setTimeout(() => t.remove(), 2200)
    }

    function showPopup(message) {
      const overlay = document.createElement('div')
      overlay.className = 'fixed inset-0 bg-black/60 flex items-center justify-center z-50 animate-fade'
      const box = document.createElement('div')
      box.className = 'bg-white text-slate-900 rounded-2xl px-6 py-4 text-center max-w-sm shadow-2xl pop'
      box.innerHTML = `<p class="text-lg font-semibold mb-2">üí¨</p><p>${message}</p>
  <button class="mt-4 rounded-xl bg-brand-500 hover:bg-brand-600 text-white px-4 py-2 font-semibold">Okay</button>`
      const btn = box.querySelector('button')
      btn.addEventListener('click', () => overlay.remove())
      overlay.appendChild(box)
      document.body.appendChild(overlay)
    }

    // Confetti helper
    function burst() { confetti({ particleCount: 140, spread: 70, origin: { y: 0.6 } }) }

    // Phases
    const phases = [
      // Phase 1: Tap the heart
      {
        title: 'Tap the heart',
        render: () => `
          <div class="bg-white/10 border border-white/10 rounded-2xl p-8 slide-in">
            <div class="text-lg">Hi ${RECIPIENT}! Start with this:</div>
            <button id="heartBtn" data-ripple class="ripple mt-6 text-5xl select-none glow">üíó</button>
            <p class="mt-4 text-slate-100/80">Give it a gentle tap.</p>
          </div>`
      },
      // Phase 2: Press & hold to charge
      {
        title: 'Hold to charge',
        render: () => `
          <div class="bg-white/10 border border-white/10 rounded-2xl p-8 slide-in">
            <p>Press and hold to fill the bar with love.</p>
            <div class="mt-4 w-full h-3 rounded-full bg-white/10 overflow-hidden border border-white/10">
              <div id="chargeBar" class="h-full w-0 bg-brand-500"></div>
            </div>
            <button id="holdBtn" data-ripple class="ripple mt-6 rounded-xl bg-brand-500 hover:bg-brand-600 px-4 py-2 font-semibold">Press & hold</button>
          </div>`
      },
      {
        title: 'Tiny Question 1',
        lockNext: true,
        render: () => `
    <div class="bg-white/10 border border-white/10 rounded-2xl p-8 slide-in">
      <p class="text-lg">Which word does Akshay secretly like about you?</p>
      <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-3">
        <button class="quiz btn rounded-xl border border-white/10 bg-white/10 hover:bg-white/15 px-4 py-3" data-correct="false">Pink Cheeks</button>
        <button class="quiz btn rounded-xl border border-white/10 bg-white/10 hover:bg-white/15 px-4 py-3" data-correct="false">Sparkling eyes</button>
        <button class="quiz btn rounded-xl border border-white/10 bg-white/10 hover:bg-white/15 px-4 py-3" data-correct="true">Everything</button>
      </div>
      <div class="text-xs mt-2 opacity-70">(Pick the right one to continue)</div>
    </div>`
      },
      {
        title: 'Tiny Question 2',
        lockNext: true,
        render: () => `
    <div class="bg-white/10 border border-white/10 rounded-2xl p-8 slide-in">
      <p class="text-lg">How should I introduce you to my nephews?</p>
      <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-3">
        <button class="quiz2 btn rounded-xl border border-white/10 bg-white/10 hover:bg-white/15 px-4 py-3" data-correct="false">Sister</button>
        <button class="quiz2 btn rounded-xl border border-white/10 bg-white/10 hover:bg-white/15 px-4 py-3" data-correct="true">Aunty</button>
        <button class="quiz2 btn rounded-xl border border-white/10 bg-white/10 hover:bg-white/15 px-4 py-3" data-correct="false">Friend</button>
      </div>
      <div class="text-xs mt-2 opacity-70">(Get this right to unlock the next step)</div>
    </div>`
      },
      // Phase 3: Slide to 100
      {
        title: 'Slide to 100%',
        render: () => `
          <div class="bg-white/10 border border-white/10 rounded-2xl p-8 slide-in">
            <p>Slide to 100% to unlock the surprise.</p>
            <input id="slider" type="range" min="0" max="100" value="0" class="mt-6 w-full" />
            <div class="mt-2 text-sm"><span id="sliderVal">0</span>%</div>
          </div>`
      },
      // Final: Cake & photo
      {
        title: 'Cake & Photo',
        render: () => `
          <div class="bg-white/10 border border-white/10 rounded-2xl p-6 slide-in">
            <div class="flex flex-col md:flex-row gap-6 items-center justify-center">
              <div class="w-[260px]">${cakeSVG()}</div>
              <div class="w-full md:w-[260px] aspect-[4/5] rounded-2xl overflow-hidden border border-white/10 bg-white/5 flex items-center justify-center">
                <img id="photo" alt="Our photo" class="max-h-full max-w-full object-cover" />
              </div>
            </div>
            <div class="text-center mt-6">
              <h3 class="text-3xl font-extrabold">Happy Birthday, ${RECIPIENT}! üéÇ</h3>
              <p class="mt-2 text-slate-100/90">From ${SENDER}, with all my love. Make a wish and blow the candles!</p>
              <div class="mt-4 flex items-center justify-center gap-2">
                <button id="blowBtn" data-ripple class="ripple rounded-xl bg-brand-500 hover:bg-brand-600 px-4 py-2 font-semibold">Blow the candles</button>
                <button id="musicBtn" data-ripple class="ripple rounded-xl border border-white/20 bg-white/10 hover:bg-white/15 px-4 py-2">Mute / Unmute ‚ô™</button>
              </div>
            </div>
          </div>`
      }
    ]

    // State & UI
    let idx = 0
    const progress = document.getElementById('progress')
    const phaseContainer = document.getElementById('phaseContainer')
    const prevBtn = document.getElementById('prevBtn')
    const nextBtn = document.getElementById('nextBtn')

    function renderProgress() {
      progress.innerHTML = phases.map((_, i) => `
        <span class="h-2 w-2 rounded-full ${i <= idx ? 'bg-brand-400' : 'bg-white/30'}"></span>
      `).join('')
    }

    function renderPhase() {
      phaseContainer.innerHTML = `
        <div class="text-sm text-slate-200/70 mb-2">${phases[idx].title}</div>
        ${phases[idx].render()}
      `
      phaseContainer.classList.remove('slide-in'); void phaseContainer.offsetWidth; phaseContainer.classList.add('slide-in')

      // Hook up interactions per phase
      nextBtn.disabled = !!phases[idx].lockNext

      if (idx === 0) initHeart()
      if (idx === 1) initHold()
      if (idx === 2) initQuiz('.quiz')    // quiz #1
      if (idx === 3) initQuiz('.quiz2')   // quiz #2
      if (idx === 4) initSlider()
      if (idx === 5) initFinal()

      prevBtn.disabled = idx === 0
      nextBtn.textContent = idx === phases.length - 1 ? 'Restart ‚Ü∫' : 'Next ‚Üí'
      renderProgress(); attachRipples();
    }

    prevBtn.addEventListener('click', () => { if (idx > 0) { idx--; renderPhase() } })
    nextBtn.addEventListener('click', () => {
      if (idx < phases.length - 1) { idx++; renderPhase() }
      else { idx = 0; renderPhase() }
    })

    // Phase 1: tap heart
    function initHeart() {
      const b = document.getElementById('heartBtn')
      b.addEventListener('click', () => { b.classList.add('pop'); burst(); toast('yaaay!'); setTimeout(() => { idx++; renderPhase() }, 500) })
    }

    function initQuiz(selector) {
      const buttons = document.querySelectorAll(selector)
      buttons.forEach(btn => {
        btn.addEventListener('click', () => {
          const correct = btn.getAttribute('data-correct') === 'true'
          if (correct) {
            burst()
            toast("That's right!")
            if (selector === '.quiz') {
              showPopup("Haha do you think I only like your pink cheeks? üíï")
            }
            if (selector === '.quiz2') {
              showPopup("Duh! you are 26 today, Aunty only üòÇ")
            }
            nextBtn.disabled = false
            setTimeout(() => { idx++; renderPhase() }, 900)
          } else {
            btn.classList.add('pop')
            toast('Yikes, isn\'t the answer obvious?')
            setTimeout(() => btn.classList.remove('pop'), 450)
          }
        })
      })
    }

    // Phase 2: press & hold
    function initHold() {
      const btn = document.getElementById('holdBtn')
      const bar = document.getElementById('chargeBar')
      let timer; let pct = 0
      const start = () => { timer = setInterval(() => { pct = Math.min(100, pct + 4); bar.style.width = pct + '%'; if (pct >= 100) { clearInterval(timer); burst(); toast('charged!'); setTimeout(() => { idx++; renderPhase() }, 400) } }, 80) }
      const stop = () => { clearInterval(timer); }
      btn.addEventListener('mousedown', start)
      btn.addEventListener('touchstart', start)
        ;['mouseup', 'mouseleave', 'touchend', 'touchcancel'].forEach(e => btn.addEventListener(e, stop))
    }

    // Phase 3: slider
    function initSlider() {
      const slider = document.getElementById('slider')
      const out = document.getElementById('sliderVal')
      slider.addEventListener('input', () => {
        out.textContent = slider.value
        if (Number(slider.value) >= 100) { burst(); toast('Unlocked!'); setTimeout(() => { idx++; renderPhase() }, 400) }
      })
    }

    // Final phase
    function initFinal() {
      const img = document.getElementById('photo'); if (img) img.src = photoSrc
      document.getElementById('blowBtn').addEventListener('click', blowCandles)

      // Mute/Unmute background music
      const musicBtn = document.getElementById('musicBtn')
      const bgm = document.getElementById('bgm')
      if (musicBtn && bgm) {
        musicBtn.addEventListener('click', () => {
          bgm.muted = !bgm.muted
          musicBtn.textContent = bgm.muted ? 'Unmute ‚ô™' : 'Mute ‚ô™'
          toast(bgm.muted ? 'Muted üîá' : 'Unmuted üîä')
        })
      }

      burst()
    }

    // Ripple effect
    function attachRipples() {
      document.querySelectorAll('[data-ripple]').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const r = btn.getBoundingClientRect();
          const d = Math.max(r.width, r.height);
          const after = document.createElement('span');
          after.style.position = 'absolute'; after.style.left = (e.clientX - r.left - d / 2) + 'px'; after.style.top = (e.clientY - r.top - d / 2) + 'px';
          after.style.width = d + 'px'; after.style.height = d + 'px'; after.style.borderRadius = '9999px';
          after.style.background = 'rgba(255,255,255,.35)'; after.style.transform = 'scale(0)'; after.style.pointerEvents = 'none';
          after.style.transition = 'transform .6s ease, opacity .6s ease'; after.style.opacity = '0.5';
          btn.appendChild(after); requestAnimationFrame(() => { after.style.transform = 'scale(1)'; after.style.opacity = '0'; });
          setTimeout(() => after.remove(), 650)
        }, { once: false })
      })
    }

    // Candles
    function blowCandles() {
      document.querySelectorAll('.flame').forEach(f => f.classList.add('opacity-0'))
      for (let i = 0; i < 3; i++) burst();
      toast('Make a wish! ‚ú®')
      for (let i = 0; i < 12; i++) setTimeout(createBalloon, i * 200)
    }

    // Balloons
    function createBalloon() {
      const colors = ['#f43f5e', '#a78bfa', '#22c55e', '#f59e0b', '#38bdf8']
      const b = document.createElement('div'); b.className = 'balloon';
      b.style.setProperty('--balloon', colors[Math.floor(Math.random() * colors.length)])
      b.style.left = Math.random() * 100 + 'vw'; b.style.setProperty('--x', (Math.random() * 80 - 40) + 'px');
      b.style.setProperty('--dur', (8 + Math.random() * 6) + 's');
      document.body.appendChild(b); setTimeout(() => b.remove(), 14000)
    }

    // Kick off
    renderPhase()

    function cakeSVG() {
      return `
      <svg viewBox="0 0 200 220" xmlns="http://www.w3.org/2000/svg" class="drop-shadow-xl">
        <ellipse cx="100" cy="200" rx="70" ry="12" fill="#e2e8f0" />
        <rect x="45" y="120" width="110" height="60" rx="14" fill="#f1c0c0" stroke="#f8d7da" stroke-width="2"/>
        <rect x="55" y="90" width="90" height="40" rx="12" fill="#ffe4e6" stroke="#ffd5dc" stroke-width="2"/>
        <path d="M55 110 q8 12 0 24 M83 110 q10 12 0 24 M105 110 q8 12 0 24 M130 110 q8 12 0 24" stroke="#f9cbd3" stroke-width="6" fill="none" stroke-linecap="round"/>
        ${[70, 100, 130].map(x => `
          <rect x="${x - 3}" y="70" width="6" height="20" rx="2" fill="#a78bfa" />
          <circle cx="${x}" cy="70" r="3" fill="#fde68a" class="flame" />
        `).join('')}
        ${Array.from({ length: 16 }).map(() => {
        const x = 55 + Math.random() * 90; const y = 130 + Math.random() * 40
        const colors = ['#f43f5e', '#a78bfa', '#22c55e', '#f59e0b']
        return `<circle cx="${x.toFixed(1)}" cy="${y.toFixed(1)}" r="1.5" fill="${colors[Math.floor(Math.random() * colors.length)]}" />`
      }).join('')}
      </svg>`
    }
  </script>
</body>

</html>
